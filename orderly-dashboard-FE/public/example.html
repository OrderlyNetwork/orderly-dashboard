<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
<!--    <link href="./stylesheets/bootstrap@5.3.2.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN">-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<body>
<div class="container text-center">
    <div class="row">
        <div class="col">
            Column
        </div>
        <div class="col">
            Column
        </div>
        <div class="col">
            Column
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col">
            <canvas id="chart1"></canvas>
        </div>
        <div class="col">
            <canvas id="chart2"></canvas>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <canvas id="chart3"></canvas>
        </div>
        <div class="col">
            <canvas id="chart4"></canvas>
        </div>
    </div>
</div>

<script src="./javascripts/chart.js@4.4.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<script>
    const ctx1 = document.getElementById('chart1');
    new Chart(ctx1, {
        type: 'bar',
        data: {
            labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
            datasets: [{
                label: '# of Votes',
                data: [12, 19, 3, 5, 2, 3],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    const ctx2 = document.getElementById('chart2');
    new Chart(ctx2, {
        type: 'line',
        data: {
            datasets: [{
                data: [{x: '2023-12-06', y: 20}, {x: '2023-12-07', y: 22}, {x: '2023-12-08', y: 24}, {x: '2023-12-09', y: 20}, {x: '2023-12-10', y: 21}, {x: '2023-12-11', y: 18}, {x: '2023-12-12', y: 25}]
            }]
        }
    });

    const data = {
        labels: [
            'Red',
            'Blue',
            'Yellow'
        ],
        datasets: [{
            label: 'My First Dataset',
            data: [300, 50, 100],
            backgroundColor: [
                'rgb(255, 99, 132)',
                'rgb(54, 162, 235)',
                'rgb(255, 205, 86)'
            ],
            hoverOffset: 4
        }]
    };


    const ctx3 = document.getElementById('chart3');
    // https://www.chartjs.org/docs/latest/charts/doughnut.html
    new Chart(ctx3, {
        type: 'doughnut',
        data: data,
    });

    var apiConfig;
    var xhr1 = new XMLHttpRequest();
    xhr1.open('GET', 'http://localhost:3000/api'+ '?t='+ (new Date()).getTime().toString());
    xhr1.send();

    xhr1.onreadystatechange = function() {
        if (xhr1.readyState == 4 && xhr1.status == 200) {
            console.log(xhr1.responseText);
            apiConfig = JSON.parse(xhr1.responseText);
            apiConfigCallback(apiConfig);
        }
    };

    function apiConfigCallback(apiConfig) {
        var xhr2 = new XMLHttpRequest();
        console.log("apiConfig.analyzer_api=", apiConfig["analyzer_api"]);
        xhr2.open('GET', apiConfig["analyzer_api"]);
        xhr2.send();

        xhr2.onreadystatechange = function() {
            if (xhr2.readyState == 4 && xhr2.status == 200) {
                console.log(xhr2.responseText);
            }
        };
    }
</script>
</body>
</html>